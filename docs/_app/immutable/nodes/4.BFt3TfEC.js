import"../chunks/CWj6FrbW.js";import{aE as ne,aC as ce,a2 as de,ar as ue,h as fe,x as z,aF as pe,an as me,p as _e,ah as x,aj as o,t as V,aG as he,k as s,ai as $,a as be,V as c,ak as r,ao as _,am as l,al as h}from"../chunks/D59Xova2.js";import{i as B}from"../chunks/Ca9ESqYv.js";import{r as G,s as ge}from"../chunks/6FIbrPCm.js";import{s as ze,a as we}from"../chunks/CNRbxWRS.js";import{l as ye,p as ke}from"../chunks/DoQ07Sil.js";import{g as Se}from"../chunks/aHzPFrNU.js";import{b as $e}from"../chunks/Da9T3RWQ.js";function I(e,d,w=d){var b=new WeakSet;ne(e,"input",async u=>{var a=u?e.defaultValue:e.value;if(a=J(e)?L(a):a,w(a),z!==null&&b.add(z),await ce(),a!==(a=d())){var p=e.selectionStart,f=e.selectionEnd,m=e.value.length;if(e.value=a??"",f!==null){var v=e.value.length;p===f&&f===m&&v>m?(e.selectionStart=v,e.selectionEnd=v):(e.selectionStart=p,e.selectionEnd=Math.min(f,v))}}}),(fe&&e.defaultValue!==e.value||de(d)==null&&e.value)&&(w(J(e)?L(e.value):e.value),z!==null&&b.add(z)),ue(()=>{var u=d();if(e===document.activeElement){var a=pe??z;if(b.has(a))return}J(e)&&u===L(e.value)||e.type==="date"&&!u&&!e.value||u!==e.value&&(e.value=u??"")})}function J(e){var d=e.type;return d==="number"||d==="range"}function L(e){return e===""?null:+e}var xe=x('<div class="error-message svelte-1s728sz"> </div>'),Ee=x('<div class="form-group svelte-1s728sz"><label for="name" class="svelte-1s728sz">Full Name</label> <div class="input-wrapper svelte-1s728sz"><i class="fa-solid fa-user svelte-1s728sz"></i> <input type="text" id="name" placeholder="John Doe" required class="svelte-1s728sz"/></div></div>'),je=x('<div class="forgot-password svelte-1s728sz"><a class="svelte-1s728sz">Forgot Password?</a></div>'),Ae=x('<div class="auth-container svelte-1s728sz"><div class="auth-card svelte-1s728sz"><h2 class="svelte-1s728sz"> </h2> <p class="subtitle svelte-1s728sz"> </p> <!> <form><!> <div class="form-group svelte-1s728sz"><label for="email" class="svelte-1s728sz">Email Address</label> <div class="input-wrapper svelte-1s728sz"><i class="fa-solid fa-envelope svelte-1s728sz"></i> <input type="email" id="email" placeholder="john@example.com" required class="svelte-1s728sz"/></div></div> <div class="form-group svelte-1s728sz"><label for="password" class="svelte-1s728sz">Password</label> <div class="input-wrapper svelte-1s728sz"><i class="fa-solid fa-lock svelte-1s728sz"></i> <input type="password" id="password" placeholder="••••••••" required class="svelte-1s728sz"/></div></div> <!> <button type="submit" class="submit-btn svelte-1s728sz"> </button></form> <div class="toggle-mode svelte-1s728sz"><p> <button class="link-btn svelte-1s728sz"> </button></p></div></div></div>');function Je(e,d){_e(d,!0);const w=()=>we(ke,"$page",b),[b,u]=ze();let a=_(!0),p=_(""),f=_(""),m=_(""),v=_(""),y=_(!1);function Z(){c(a,!s(a)),c(v,"")}async function ee(){c(v,""),c(y,!0);const i=`http://localhost:8000${s(a)?"/api/login":"/api/register"}`;try{const n={email:s(p),password:s(f)};s(a)||(n.name=s(m));const g=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),S=await g.json();if(!g.ok)throw new Error(S.message||"Something went wrong");if(s(a)){const F=S.token,ve=await(await fetch("http://localhost:8000/api/user",{headers:{Authorization:`Bearer ${F}`}})).json();ye(F,ve);const Y=w().url.searchParams.get("callback");Y?window.location.href=`${Y}?token=${F}`:Se("/profile")}else c(a,!0),c(v,"Account created! Please sign in.")}catch(n){c(v,n.message,!0)}finally{c(y,!1)}}var E=Ae(),M=r(E),j=r(M),ae=r(j,!0);l(j);var A=o(j,2),se=r(A,!0);l(A);var N=o(A,2);{var te=t=>{var i=xe(),n=r(i,!0);l(i),V(()=>h(n,s(v))),$(t,i)};B(N,t=>{s(v)&&t(te)})}var k=o(N,2),O=r(k);{var re=t=>{var i=Ee(),n=o(r(i),2),g=o(r(n),2);G(g),l(n),l(i),I(g,()=>s(m),S=>c(m,S)),$(t,i)};B(O,t=>{s(a)||t(re)})}var P=o(O,2),R=o(r(P),2),T=o(r(R),2);G(T),l(R),l(P);var D=o(P,2),U=o(r(D),2),W=o(r(U),2);G(W),l(U),l(D);var H=o(D,2);{var le=t=>{var i=je(),n=r(i);l(i),V(()=>ge(n,"href",`${$e??""}/forgot-password`)),$(t,i)};B(H,t=>{s(a)&&t(le)})}var q=o(H,2),oe=r(q,!0);l(q),l(k);var K=o(k,2),Q=r(K),X=r(Q),C=o(X);C.__click=Z;var ie=r(C,!0);l(C),l(Q),l(K),l(M),l(E),V(()=>{h(ae,s(a)?"Welcome Back":"Create Account"),h(se,s(a)?"Enter your details to access your account":"Get started with your free account today"),q.disabled=s(y),h(oe,s(y)?"Loading...":s(a)?"Sign In":"Sign Up"),h(X,`${s(a)?"Don't have an account?":"Already have an account?"} `),h(ie,s(a)?"Sign Up":"Sign In")}),he("submit",k,t=>{t.preventDefault(),ee()}),I(T,()=>s(p),t=>c(p,t)),I(W,()=>s(f),t=>c(f,t)),$(e,E),be(),u()}me(["click"]);export{Je as component};
